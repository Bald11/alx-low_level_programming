more nested loops and stuff
